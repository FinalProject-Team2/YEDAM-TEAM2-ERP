<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}">
<head>
    <meta charset="UTF-8">
    <title>사원 계정 관리</title>

    <!-- Toast UI Grid -->
    <link rel="stylesheet"
          href="https://uicdn.toast.com/grid/latest/tui-grid.css" />
    <script src="https://uicdn.toast.com/grid/latest/tui-grid.js"></script>

    <style>
        .emp-account-wrapper .card-title {
            font-weight: 600;
            font-size: 1.1rem;
        }

        .emp-account-wrapper #empGrid,
        .emp-account-wrapper #roleGrid {
            width: 100%;
            margin-top: 4px;
        }

        .emp-account-wrapper .help-text {
            font-size: 12px;
            color: #6c757d;
        }

        .emp-account-wrapper .card-header-left {
            display: flex;
            align-items: center;
        }

        .emp-account-wrapper .card-header-left .card-title {
            margin-bottom: 0;
        }

        .emp-account-wrapper .tui-grid-header-area .tui-grid-cell-row-header {
            background-color: #f5f5f5;
        }
        .emp-account-wrapper .tui-grid-body-area .tui-grid-cell-row-header {
            background-color: #ffffff;
        }
    </style>
</head>

<body layout:fragment="content">
<div class="emp-account-wrapper">

    <!-- ================= 사원 조회 ================= -->
    <div class="row">
        <div class="col-md-12 mb-3">
            <div class="card">
                <div class="card-header">
                    <div class="card-header-left">
                        <h5 class="card-title">사원 조회</h5>
                    </div>
                    <div class="card-header-right">
                        <button class="btn btn-dark" type="button">초기화</button>
                        <button class="btn btn-outline-dark" type="button">조회</button>
                    </div>
                </div>

                <div class="card-body">
                    <div class="row mb-2">
                        <div class="col-md-3">
                            <label for="deptName">부서 명</label>
                            <select id="deptName" class="form-select">
                                <option value="">YEDAM</option>
                                <option value="HR">인사</option>
                                <option value="SALES">영업</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <label for="jobName">직급 명</label>
                            <select id="jobName" class="form-select">
                                <option value="">YEDAM</option>
                                <option>사원</option>
                                <option>대리</option>
                                <option>과장</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <label for="empName">사원 이름</label>
                            <input id="empName"
                                   type="text"
                                   class="form-control"
                                   placeholder="홍길동">
                        </div>
                        <div class="col-md-3">
                            <label for="accountId">계정 ID</label>
                            <input id="accountId"
                                   type="text"
                                   class="form-control"
                                   placeholder="HONG@HONG.AC">
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- ================= 사원 목록 (3줄 고정 + 스크롤) ================= -->
    <div class="row">
        <div class="col-md-12 mb-3">
            <div class="card">
                <div class="card-header">
                    <div class="card-header-left">
                        <h5 class="card-title me-2">사원 목록</h5>
                        <span class="help-text">
                            * 사원 목록에서 대상을 선택하면 아래에서 계정을 생성·변경할 수 있습니다.
                            계정 상태에 따라 임시 비밀번호 발급 및 문자 전송 방식이 달라집니다.
                        </span>
                    </div>
                    <div class="card-header-right"></div>
                </div>

                <div class="card-body">
                    <div id="empGrid"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- ========== 아래 한 행: 계정 정보 + 역할 설정 ========== -->
    <div class="row">
        <!-- 사원 계정 정보 (왼쪽, 좀 더 넓게) -->
        <div class="col-md-7 mb-3">
            <div class="card h-100">
                <div class="card-header">
                    <div class="card-header-left">
                        <h5 class="card-title">사원 계정 정보</h5>
                    </div>
                    <div class="card-header-right">
                        <button type="button" class="btn btn-outline-dark">저장</button>
                    </div>
                </div>

                <div class="card-body">
                    <!-- 1행: 부서 / 직급 / 사번 -->
                    <div class="row mb-2">
                        <div class="col-md-4">
                            <label>부서 명</label>
                            <input type="text"
                                   class="form-control form-control-sm"
                                   placeholder="YEDAM">
                        </div>
                        <div class="col-md-4">
                            <label>직급 명</label>
                            <input type="text"
                                   class="form-control form-control-sm"
                                   placeholder="사원">
                        </div>
                        <div class="col-md-4">
                            <label>사번</label>
                            <input type="text"
                                   class="form-control form-control-sm"
                                   placeholder="2511001">
                        </div>
                    </div>

                    <!-- 2행: 사원명 / 연락처 / 이메일 -->
                    <div class="row mb-2">
                        <div class="col-md-4">
                            <label>사원 명</label>
                            <input type="text"
                                   class="form-control form-control-sm"
                                   placeholder="홍길동">
                        </div>
                        <div class="col-md-4">
                            <label>연락처</label>
                            <input type="text"
                                   class="form-control form-control-sm"
                                   placeholder="010-1111-1234">
                        </div>
                        <div class="col-md-4">
                            <label>이메일</label>
                            <input type="email"
                                   class="form-control form-control-sm"
                                   placeholder="YEDAM@YEDAM.AC">
                        </div>
                    </div>

                    <!-- 3행: 회사코드 / 아이디 / 계정상태 -->
                    <div class="row mb-2">
                        <div class="col-md-4">
                            <label>회사 코드</label>
                            <input type="text"
                                   class="form-control form-control-sm"
                                   placeholder="CO_YEDAM001">
                        </div>
                        <div class="col-md-4">
                            <label>아이디</label>
                            <input type="text"
                                   class="form-control form-control-sm"
                                   placeholder="HONG@HONG.AC">
                        </div>
                        <div class="col-md-4">
                            <label class="astar">계정 상태</label>
                            <select class="form-select form-select-sm">
                                <option>ACTIVE</option>
                                <option>LOCKED</option>
                                <option>INACTIVE</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 계정 역할 설정 (오른쪽, 폭 줄임) -->
        <div class="col-md-5 mb-3">
            <div class="card h-100">
                <div class="card-header">
                    <div class="card-header-left">
                        <h5 class="card-title me-2 mb-0">계정 역할 설정</h5>
                        <span class="help-text">※ 계정이 존재할 경우, 설정 가능합니다.</span>
                    </div>
                    <div class="card-header-right">
                        <button type="button" class="btn btn-outline-dark">역할 조회</button>
                        <button type="button" class="btn btn-outline-dark">저장</button>
                        <button type="button" class="btn btn-danger">삭제</button>
                    </div>
                </div>

                <div class="card-body">
                    <div id="roleGrid"></div>
                </div>
            </div>
        </div>
    </div>

</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        if (!window.tui || !tui.Grid) {
            return;
        }

        // === 공통 값 ===
        const rowHeight = 40;

        // 사원 목록용: 3줄 고정
        const empGridOptions = {
            bodyHeight: rowHeight * 3,   // 3행
            rowHeight: rowHeight,
            scrollX: false,
            scrollY: true,
            columnOptions: {
                minWidth: 80,
                resizable: true
            }
        };

        // 계정 역할 설정용: 4줄 고정
        const roleGridOptions = {
            ...empGridOptions,
            bodyHeight: rowHeight * 4    // 4행
        };

        // ===== 더미 데이터 =====
        const empData = [
            { deptName: 'YEDAM', jobName: '사원', empNo: '2511001', empName: '홍길동', hasAccount: 'Y', status: 'ACTIVE' },
            { deptName: 'YEDAM', jobName: '사원', empNo: '2511002', empName: '김영업', hasAccount: 'N', status: 'LOCKED' },
            { deptName: 'YEDAM', jobName: '과장', empNo: '2511003', empName: '박관리', hasAccount: 'Y', status: 'INACTIVE' },
            { deptName: 'YEDAM', jobName: '과장', empNo: '2511003', empName: '박관리', hasAccount: 'Y', status: 'INACTIVE' },
            { deptName: 'YEDAM', jobName: '과장', empNo: '2511003', empName: '박관리', hasAccount: 'Y', status: 'INACTIVE' },
            // 더 많아져도 Grid 안에서만 스크롤
        ];

        const roleData = [
            { checked: true,  roleName: '인사 담당',     roleType: '인사' },
            { checked: false, roleName: '영업 담당',     roleType: '영업' },
            { checked: false, roleName: '시스템 관리자', roleType: '공통' },
            { checked: false, roleName: '추가 역할 예시', roleType: '기타' },
            { checked: false, roleName: '추가 역할 예시', roleType: '기타' },
            { checked: false, roleName: '추가 역할 예시', roleType: '기타' }
        ];

        // ===== 사원 목록 Grid (3줄) =====
        const empGrid = new tui.Grid({
            el: document.getElementById('empGrid'),
            data: empData,
            rowHeaders: [],
            ...empGridOptions,
            columns: [
                { header: '부서 명',        name: 'deptName',   minWidth: 100 },
                { header: '직급 명',        name: 'jobName',    minWidth: 100 },
                { header: '사번',           name: 'empNo',      minWidth: 100 },
                { header: '사원 명',        name: 'empName',    minWidth: 120 },
                { header: '계정 존재 유무', name: 'hasAccount', width: 110 },
                { header: '계정 상태',      name: 'status',     minWidth: 100 }
            ]
        });

        // ===== 계정 역할 설정 Grid (4줄) =====
        const roleGrid = new tui.Grid({
            el: document.getElementById('roleGrid'),
            data: roleData,
            rowHeaders: ['checkbox'],
            ...roleGridOptions,
            columns: [
                { header: '역할 명',   name: 'roleName', minWidth: 130 },
                { header: '역할 유형', name: 'roleType', minWidth: 90 }
            ]
        });

        // 초기 checked 값 반영
        roleGrid.getData().forEach(function (row) {
            if (row.checked) {
                roleGrid.check(row.rowKey);
            }
        });

        // 체크/해제 시 checked 필드 동기화
        roleGrid.on('check', function (ev) {
            roleGrid.setValue(ev.rowKey, 'checked', true, false);
        });
        roleGrid.on('uncheck', function (ev) {
            roleGrid.setValue(ev.rowKey, 'checked', false, false);
        });
        roleGrid.on('checkAll', function () {
            roleGrid.getData().forEach(function (row) {
                roleGrid.setValue(row.rowKey, 'checked', true, false);
            });
        });
        roleGrid.on('uncheckAll', function () {
            roleGrid.getData().forEach(function (row) {
                roleGrid.setValue(row.rowKey, 'checked', false, false);
            });
        });
    });
</script>


</body>
</html>
