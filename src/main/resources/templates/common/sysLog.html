<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout}">
<head>
<meta charset="UTF-8">
<title>시스템 로그 조회</title>

<!-- Toast UI Grid -->
<link rel="stylesheet"
	href="https://uicdn.toast.com/grid/latest/tui-grid.css" />
<script src="https://uicdn.toast.com/grid/latest/tui-grid.js"></script>

<!-- bootstrap-datepicker (공통 util에서 초기화만 담당) -->
<script
	src="assets/vendors/bootstrap-datepicker/bootstrap-datepicker.min.js"></script>

<!-- 아이콘 -->
<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

<style>
.log-wrapper .card-title {
	font-weight: 600;
}

/* Grid 컨테이너 */
.log-wrapper #logGrid {
	width: 100%;
	margin-top: 4px;
}

/* row header 색상은 style.css 공통(.tui-grid-header-area / body-area) 사용 */
</style>
</head>

<body layout:fragment="content">
	<div class="log-wrapper">

		<!-- 검색 영역 -->
		<div class="card mb-3">
			<div class="card-header">
				<div class="card-header-left">
					<h5 class="card-title">시스템 로그 조회</h5>
				</div>
				<div class="card-header-right">
					<button type="button" class="btn btn-dark">초기화</button>
					<button type="button" class="btn btn-outline-dark">조회</button>
				</div>
			</div>

			<div class="card-body">
				<div class="row mb-2">
					<div class="col-md-3">
						<label for="accountId" class="form-label">계정 ID</label> <input
							id="accountId" type="text" class="form-control"
							placeholder="HONG@NON.AC">
					</div>
					<div class="col-md-3">
						<label for="module" class="form-label">모듈</label> <select
							id="module" class="form-select">
							<option value="">전체</option>
							<option value="COMMON">공통</option>
							<option value="HR">인사</option>
							<option value="SALES">영업</option>
						</select>
					</div>
					<div class="col-md-3">
						<label for="action" class="form-label">액션</label> <select
							id="action" class="form-select">
							<option value="">전체</option>
							<option value="LOGIN">LOGIN</option>
							<option value="INSERT">INSERT</option>
							<option value="UPDATE">UPDATE</option>
							<option value="DELETE">DELETE</option>
						</select>
					</div>

					<div class="col-md-3">
						<label class="form-label">로그 발생 일시</label>
						<div class="d-flex align-items-center js-date-range">

							<!-- 시작일 -->
							<div class="input-group date">
								<input type="text"
									class="form-control datepicker js-date-range-start"
									placeholder="시작일"> <span
									class="input-group-text js-date-range-icon-start"> <i
									class="bi bi-calendar"></i>
								</span>
							</div>

							<span class="mx-1 fw-bold fs-5">~</span>

							<!-- 종료일 -->
							<div class="input-group date ms-2">
								<input type="text"
									class="form-control datepicker js-date-range-end"
									placeholder="종료일"> <span
									class="input-group-text js-date-range-icon-end"> <i
									class="bi bi-calendar"></i>
								</span>
							</div>
						</div>

					</div>
				</div>
			</div>
		</div>

		<!-- 로그 목록 영역 -->
		<div class="card">
			<div class="card-header">
				<div class="card-header-left">
					<h5 class="card-title">로그 목록</h5>
				</div>
				<div class="card-header-right">
					<!-- 버튼 없음(필요 시 추가) -->
				</div>
			</div>

			<div class="card-body">
				<div id="logGrid"></div>
			</div>
		</div>

	</div>

	<script>
		document.addEventListener('DOMContentLoaded', function() {
			// Toast UI Grid가 없으면 종료 (방어코드)
			if (!window.tui || !tui.Grid) {
				return;
			}

			// 화면 테스트용 더미 데이터
			const logData = [ {
				occurredAt : '2019-05-05 09:12:54',
				accountId : 'HONG@YEDAM.AC',
				module : '공통',
				action : 'LOGIN',
				targetTable : '-',
				targetId : '-',
				summary : '깃 스테이징용'
			}, {
				occurredAt : '2019-05-05 09:12:54',
				accountId : 'HONG@YEDAM.AC',
				module : '공통',
				action : 'LOGIN',
				targetTable : '-',
				targetId : '-',
				summary : '관리자 로그인'
			}, {
				occurredAt : '2019-05-06 10:11:22',
				accountId : 'KIM@NON.AC',
				module : '주문',
				action : 'INSERT',
				targetTable : 'ORDER',
				targetId : 'ORD_20240501_001',
				summary : '주문 등록'
			} ];

			// Grid 생성 (테마, rowHeader 색상은 teamUtil.js + style.css 공통 적용)
			const logGrid = new tui.Grid({
				el : document.getElementById('logGrid'),
				data : logData,
				bodyHeight : 320,
				scrollX : false,
				scrollY : false,
				rowHeaders : [ 'checkbox' ],
				columnOptions : {
					minWidth : 80,
					resizable : true
				},
				columns : [ {
					header : '발생 일시',
					name : 'occurredAt',
					minWidth : 160,
					align : 'right'
				}, {
					header : '계정 ID',
					name : 'accountId',
					minWidth : 160
				}, {
					header : '모듈',
					name : 'module',
					minWidth : 100
				}, {
					header : '액션',
					name : 'action',
					minWidth : 100
				}, {
					header : '대상 테이블',
					name : 'targetTable',
					minWidth : 120
				}, {
					header : '대상 ID',
					name : 'targetId',
					minWidth : 160
				}, {
					header : '요약 정보',
					name : 'summary',
					minWidth : 200
				} ]
			});

			// 필요 시 리사이즈 대응
			window.addEventListener('resize', function() {
				logGrid.refreshLayout();
			});
		});
	</script>

</body>
</html>
